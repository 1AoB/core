--- skia/include/private/base/SkAssert.h.orig
+++ skia/include/private/base/SkAssert.h
@@ -60,6 +60,13 @@
     } while (false)
 #endif
 
+// when building with msvc and only when using these headers outside the skia build
+#if defined(_MSC_VER) && !SKIA_IMPLEMENTATION
+#    define SkANALYSIS_ASSUME(condition) __analysis_assume(condition)
+#else
+#    define SkANALYSIS_ASSUME(condition) static_cast<void>(0)
+#endif
+
 // SkASSERT, SkASSERTF and SkASSERT_RELEASE can be used as standalone assertion expressions, e.g.
 //    uint32_t foo(int x) {
 //        SkASSERT(x > 4);
@@ -77,7 +83,7 @@
         : []{ SK_ABORT("check(%s)", #cond); }() )
 #else
 #define SkASSERT_RELEASE(cond) \
-    static_cast<void>( (cond) ? static_cast<void>(0) : []{ SK_ABORT("check(%s)", #cond); }() )
+    static_cast<void>( (cond) ? static_cast<void>(0) : [&]{ SK_ABORT("check(%s)", #cond); SkANALYSIS_ASSUME(cond); }() )
 #endif

 #if defined(SK_DEBUG)

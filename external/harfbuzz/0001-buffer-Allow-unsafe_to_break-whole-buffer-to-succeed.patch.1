From 39896512cfd6f37e416cdc9c598e977d9548426a Mon Sep 17 00:00:00 2001
From: Behdad Esfahbod <behdad@behdad.org>
Date: Wed, 7 May 2025 16:11:37 -0600
Subject: [PATCH] [buffer] Allow unsafe_to_break() whole buffer to succeed

Fixes https://github.com/harfbuzz/harfbuzz/pull/5315
---
 src/hb-buffer.hh | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/hb-buffer.hh b/src/hb-buffer.hh
index 6c620db69..1a534aad2 100644
--- a/src/hb-buffer.hh
+++ b/src/hb-buffer.hh
@@ -410,11 +410,11 @@ struct hb_buffer_t
 			 bool interior = false,
 			 bool from_out_buffer = false)
   {
-    end = hb_min (end, len);
-
-    if (unlikely (end - start > 255))
+    if (unlikely (end != (unsigned) -1 && end - start > 255))
       return;
 
+    end = hb_min (end, len);
+
     if (interior && !from_out_buffer && end - start < 2)
       return;
 
-- 
2.49.0

